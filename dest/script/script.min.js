var travelServiceModule=angular.module("travelServiceModule",[]);travelServiceModule.service("travelIndexListService",function(a){var b="http://api.development.mastergolf.cn/v10/tourism/travels.json";this.traveListGet=function(){return a({url:b,method:"GET"})}}),travelServiceModule.service("travelDetailsService",function(a){var b="http://api.development.mastergolf.cn/v10/tourism/travels/show.json?uuid=";this.traveDetailsGet=function(c){return a({url:b+c,method:"GET"})}}),travelServiceModule.service("orderCreatService",function(a){var b="http://api.development.mastergolf.cn/v10/tourism/orders/create.json";this.ajaxSubmit=function(c){return a({method:"POST",url:b,data:c})}}),travelServiceModule.service("pageJumpService",["$state",function(a){this.statego=function(b,c){a.go(b,{uuid:c})}}]),travelServiceModule.factory("orderValidateService",["$http",function(a){var b={name:function(a){return/^[\u4E00-\u9FA5A-Za-z]+$/.test(a)},phone:function(a){return/^0{0,1}(13[0-9]|15[7-9]|153|156|18[7-9])[0-9]{8}$/.test(a)}};return b}]),travelServiceModule.service("promptService",["$timeout",function(a){this.promit=function(){var a='<p class="pf" style="top:0px">xxxxxx</p>';document.body.innerHTML+=a}}]);var travelDirceitve=angular.module("travelDirectiveModule",["travelListModule","travelDetailsModule","ngTouch"]);travelDirceitve.directive("lazyimglist",["$timeout",function(a){return{restrict:"AE",replace:!1,link:function(b,c,d){function e(){this.img=document.querySelectorAll(".loadimg"),this.w_h=document.documentElement.clientHeight,this.datasrc="datalazysrc",this.imglength=this.img.length,this.nowi=0}e.prototype.scrolladd=function(){var a=this;if(!(a.nowi>=a.img.length-1)){var b=document.body.scrollTop,c=b+a.w_h+20;for(i=a.nowi;i<a.imglength;i++){var d=a.img[i],e=d.getAttribute(a.datasrc),f=d.getAttribute("src"),g=d.parentNode.offsetTop;e!=f&&c>g&&(d.setAttribute("src",e),a.nowi=i)}}},1==b.$last&&a(function(){var a=new e;a.scrolladd(),window.onscroll=function(){a.scrolladd()}})}}}]),travelDirceitve.directive("bannerli",["$timeout",function(a){return{restrict:"A",replace:!1,link:function(b,c,d){function e(a){this.bannerbox=$("#bannerbox"),this.bannerid="#bannerbox",this.li_width=this.bannerbox.width(),this.banner_ul=$("#banner-ul"),this.timer="",this.index=0,this.evx=0,this.timer=null}e.prototype.init=function(){var a=this;a.banner_li=a.banner_ul.children("li"),a.li_length=a.banner_ul.children("li").length,a.banner_li.css("width",a.li_width+"px"),a.bannerAuto(),touch.on(a.bannerid,"touchstart",function(a){a.preventDefault()}),touch.on(a.bannerid,"drag",function(b){clearInterval(a.timer);var c=-a.index*a.li_width+b.x;a.evx=b.x,a.banner_ul.css({"-webkit-transition":"0.0s  linear",transition:"0.0s  linear","-webkit-transform":"translate3d("+c+"px,0,0)",transform:"translate3d("+c+"px,0,0)"})}),touch.on(a.bannerid,"dragend",function(b){var c=0;a.evx>0&&0!==a.index?a.index--:a.evx<0&&a.index!=a.li_length-1&&a.index++,c=-a.index*a.li_width,a.bannerAction(c),a.bannerAuto()})},e.prototype.bannerAction=function(a){var b=this;b.banner_ul.css({"-webkit-transition":"0.5s  linear",transition:"0.5s  linear","-webkit-transform":"translate3d("+a+"px,0,0)",transform:"translate3d("+a+"px,0,0)"})},e.prototype.bannerAuto=function(){var a=this;a.timer=setInterval(function(){a.index++,a.index>a.li_length-1&&(a.index=0),_offx=-a.index*a.li_width,a.bannerAction(_offx)},3e3)},1==b.$last&&a(function(){var a=new e;a.init()})}}}]);var travelFilterModule=angular.module("travelFilterModule",[]);travelFilterModule.filter("trustHtml",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]);var orderCreatModule=angular.module("orderCreatModule",["travelServiceModule"]);orderCreatModule.controller("orderCreatCtrl",["$scope","$state","$stateParams","$cookieStore","travelDetailsService","orderCreatService","orderValidateService","promptService",function(a,b,c,d,e,f,g,h){a.parseInt=parseInt,d.put("user_uuid","5734fda9-61c6-42b4-82ce-b1314e291bbd"),d.put("token","63bae8001c7b61f6d14b5bed19c912be");var i=d.get("user_uuid"),j=d.get("token");if(!j||!i){var k=window.location.href;window.location.href="mastergolf://mastergolf.cn/user/login?url="+k}a.travleDetailsData="",a.adult_count=1,a.child_count=0,a.link_man="",a.phone="",a.insurance_count=0,a.all_people=1,e.traveDetailsGet(c.uuid).success(function(b,c,d,e){a.travleDetailsData=b.data,a.adult_price=parseInt(a.travleDetailsData.adult_price)||0,a.child_price=parseInt(a.travleDetailsData.child_price)||0,a.assurance_price=parseInt(a.travleDetailsData.assurance_price)||0,a.total_price=a.adult_price*a.adult_count+a.child_price*a.child_count+a.assurance_price*a.insurance_count});var l=function(){a.all_people=a.adult_count+a.child_count,a.insurance_count=a.insurance_count>a.all_people?a.all_people:a.insurance_count,a.total_price=a.adult_price*a.adult_count+a.child_price*a.child_count+a.assurance_price*a.insurance_count};a.addNumberFn=function(b){"adult_count"===b&&a.adult_count++,"child_count"===b&&a.child_count++,"insurance_count"===b&&(a.insurance_count++,a.insurance_count=a.insurance_count>a.all_people?a.all_people:a.insurance_count),l()},a.minusNumberFn=function(b){"adult_count"===b&&(a.adult_count--,a.adult_count=a.adult_count<=1?1:a.adult_count),"child_count"===b&&(a.child_count--,a.child_count=a.child_count<0?0:a.child_count),"insurance_count"===b&&(a.insurance_count--,a.insurance_count=a.insurance_count<0?0:a.insurance_count),l()};var m=!1,n=!1;a.bool_submit=!1,a.validate={Vphone:function(b){return n=g.phone(b),a.bool_submit=m&&n,n},Vname:function(b){return m=g.name(b),a.bool_submit=m&&n,m}},a.submitOrder=function(){a.bool_submit&&f.ajaxSubmit({uuid:c.uuid,user_uuid:i,token:j,adult_count:a.adult_count,child_count:a.child_count,link_man:a.link_man,phone:a.phone,insurance_count:a.insurance_count}).success(function(a,b,c,d){"OK"===a.data.state})},a.statego=function(a,b){pageJumpService.statego(a,b)}}]);var travelDetailsModule=angular.module("travelDetailsModule",["travelServiceModule","travelFilterModule"]);travelDetailsModule.controller("travelDetailsCtrl",["$scope","$state","$stateParams","travelDetailsService","pageJumpService",function(a,b,c,d,e){d.traveDetailsGet(c.uuid).success(function(b,c,d,e){a.travleDetailsData=b.data}),a.statego=function(a,b){e.statego(a,b)}}]);var travelListModule=angular.module("travelListModule",["travelServiceModule"]);travelListModule.controller("travelIndexListCtrl",["$scope","$state","travelIndexListService","pageJumpService",function(a,b,c,d){a.tab=1,c.traveListGet().success(function(b,c,d,e){a.traveListData=b.data}).error(function(a,b,c,d){}),a.statego=function(a,b){d.statego(a,b)}}]);var travelApp=angular.module("travelApp",["ui.router","ngTouch","ngAnimate","ngCookies","travelListModule","travelServiceModule","travelDirectiveModule","travelDetailsModule","travelFilterModule","orderCreatModule"]);travelApp.run(function(a,b,c){a.$state=b,a.$stateParams=c,a.tab=1}),travelApp.config(function(a,b){b.otherwise("/index"),a.state("index",{url:"/index",templateUrl:"views/travel_index_list.html",controller:"travelIndexListCtrl"}).state("details",{url:"/details/:uuid",templateUrl:"views/travel_details.html",controller:"travelDetailsCtrl"}).state("ordercreat",{url:"/ordercreat/:uuid",templateUrl:"views/order_creat.html",controller:"orderCreatCtrl"})});